groups:
  - name: "Container Image"
    description: "容器镜像"
  - name: "Controller"
    description: "配置工作负载部署"
  - name: "Container Configuration"
    description: "附加容器配置"
  - name: "App Configuration"
    description: "特定于应用程序的配置选项"
  - name: "Networking and Services"
    description: "为容器配置网络和服务"
  - name: "Storage and Persistence"
    description: "持久化并共享与容器分离的数据"
  - name: "Resources and Devices"
    description: "指定要分配给工作负载的资源/设备"
questions:
  - variable: portal
    group: "Container Image"
    label: "配置门户按钮"
    schema:
      type: dict
      hidden: true
      attrs:
        - variable: enabled
          label: "Enable"
          description: "启用门户按钮"
          schema:
            hidden: true
            editable: false
            type: boolean
            default: false
  - variable: global
    label: "全局设置"
    group: "Controller"
    schema:
      type: dict
      hidden: true
      attrs:
        - variable: isSCALE
          label: "flag this is SCALE"
          schema:
            type: boolean
            default: true
            hidden: true
  - variable: controller
    group: "Controller"
    label: ""
    schema:
      type: dict
      attrs:
        - variable: advanced
          label: "显示高级控制器设置"
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: type
                description: "请指定要部署的工作负载类型"
                label: "（高级）控制器类型"
                schema:
                  type: string
                  default: "statefulset"
                  required: true
                  enum:
                    - value: "deployment"
                      description: "Deployment"
                    - value: "statefulset"
                      description: "Statefulset"
                    - value: "daemonset"
                      description: "Daemonset"
              - variable: replicas
                description: "所需pod副本的数量"
                label: "所需副本"
                schema:
                  type: int
                  default: 1
                  required: true
              - variable: strategy
                description: "请指定要部署的工作负载类型"
                label: "（高级）更新策略"
                schema:
                  type: string
                  default: "RollingUpdate"
                  required: true
                  enum:
                    - value: "Recreate"
                      description: "重新创建: 杀掉现有pod后再创建新pod"
                    - value: "RollingUpdate"
                      description: "滚动更新: 创建新pod后再杀掉旧pod"
                    - value: "OnDelete"
                      description: "(Legacy) OnDelete: ignore .spec.template changes"
        - variable: expert
          label: "显示专业配置选项"
          schema:
            type: boolean
            default: false
            show_subquestions_if: true
            subquestions:
              - variable: extraArgs
                label: "扩展参数"
                schema:
                  type: list
                  default: []
                  items:
                    - variable: argItem
                      label: "Arg"
                      schema:
                        type: dict
                        attrs:
                          - variable: name
                            label: "Name"
                            schema:
                              type: string
                          - variable: value
                            label: "Value"
                            schema:
                              type: string
              - variable: labelsList
                label: "Controller Labels"
                schema:
                  type: list
                  default: []
                  items:
                    - variable: labelItem
                      label: "Label"
                      schema:
                        type: dict
                        attrs:
                          - variable: name
                            label: "Name"
                            schema:
                              type: string
                          - variable: value
                            label: "Value"
                            schema:
                              type: string
              - variable: annotationsList
                label: "Controller Annotations"
                schema:
                  type: list
                  default: []
                  items:
                    - variable: annotationItem
                      label: "Label"
                      schema:
                        type: dict
                        attrs:
                          - variable: name
                            label: "Name"
                            schema:
                              type: string
                          - variable: value
                            label: "Value"
                            schema:
                              type: string

  - variable: env
    group: "Container Configuration"
    label: "镜像环境"
    schema:
      type: dict
      attrs:
        - variable: TZ
          label: "Timezone"
          schema:
            type: string
            default: "Asia/Shanghai"
            $ref:
              - "definitions/timezone"
        - variable: UMASK
          label: "UMASK"
          description: "Sets the UMASK env var for LinuxServer.io (compatible) containers"
          schema:
            type: string
            default: "002"

  - variable: envList
    label: "镜像环境"
    group: "Container Configuration"
    schema:
      type: list
      default: []
      items:
        - variable: envItem
          label: "环境变量"
          schema:
            type: dict
            attrs:
              - variable: name
                label: "Name"
                schema:
                  type: string
              - variable: value
                label: "Value"
                schema:
                  type: string

  - variable: expertpodconf
    group: "Container Configuration"
    label: "Show Expert Config"
    schema:
      type: boolean
      default: false
      show_subquestions_if: true
      subquestions:
        - variable: termination
          group: "Container Configuration"
          label: "终止设置"
          schema:
            type: dict
            attrs:
              - variable: gracePeriodSeconds
                label: "Grace Period Seconds"
                schema:
                  type: int
                  default: 10
        - variable: podLabelsList
          group: "Container Configuration"
          label: "Pod Labels"
          schema:
            type: list
            default: []
            items:
              - variable: podLabelItem
                label: "Label"
                schema:
                  type: dict
                  attrs:
                    - variable: name
                      label: "Name"
                      schema:
                        type: string
                    - variable: value
                      label: "Value"
                      schema:
                        type: string

        - variable: podAnnotationsList
          group: "Container Configuration"
          label: "Pod Annotations"
          schema:
            type: list
            default: []
            items:
              - variable: podAnnotationItem
                label: "Label"
                schema:
                  type: dict
                  attrs:
                    - variable: name
                      label: "Name"
                      schema:
                        type: string
                    - variable: value
                      label: "Value"
                      schema:
                        type: string

  - variable: mysqlRootPassword
    group: "App Configuration"
    label: "Root密码"
    schema:
      type: string
      default: ""
      required: true

  - variable: service
    group: "Networking and Services"
    label: "Configure Service(s)"
    schema:
      type: dict
      attrs:
        - variable: main
          label: "Main Service"
          description: "The Primary service on which the healthcheck runs, often the webUI"
          schema:
            type: dict
            attrs:
              - variable: enabled
                label: "Enable the service"
                schema:
                  type: boolean
                  default: true
                  hidden: true
              - variable: type
                label: "Service Type"
                description: "ClusterIP's are only internally available, nodePorts expose the container to the host node System, Loadbalancer exposes the service using the system loadbalancer"
                schema:
                  type: string
                  default: "Simple"
                  enum:
                    - value: "Simple"
                      description: "Simple"
                    - value: "ClusterIP"
                      description: "ClusterIP"
                    - value: "NodePort"
                      description: "NodePort (Advanced)"
                    - value: "LoadBalancer"
                      description: "LoadBalancer (Advanced)"
              - variable: loadBalancerIP
                label: "LoadBalancer IP"
                description: "LoadBalancerIP"
                schema:
                  show_if: [["type", "=", "LoadBalancer"]]
                  type: string
                  default: ""
              - variable: externalIPs
                label: "External IP's"
                description: "External IP's"
                schema:
                  show_if: [["type", "=", "LoadBalancer"]]
                  type: list
                  default: []
                  items:
                    - variable: externalIP
                      label: "External IP"
                      schema:
                        type: string
              - variable: ports
                label: "Service's Port(s) Configuration"
                schema:
                  type: dict
                  attrs:
                    - variable: main
                      label: "Main Service Port Configuration"
                      schema:
                        type: dict
                        attrs:
                          - variable: port
                            label: "Port"
                            description: "This port exposes the container port on the service"
                            schema:
                              type: int
                              default: 3306
                              editable: true
                              required: true
                          - variable: advanced
                            label: "Show Advanced settings"
                            schema:
                              type: boolean
                              default: false
                              show_subquestions_if: true
                              subquestions:
                                - variable: protocol
                                  label: "Port Type"
                                  schema:
                                    type: string
                                    default: "TCP"
                                    enum:
                                      - value: HTTP
                                        description: "HTTP"
                                      - value: "HTTPS"
                                        description: "HTTPS"
                                      - value: TCP
                                        description: "TCP"
                                      - value: "UDP"
                                        description: "UDP"
                                - variable: nodePort
                                  label: "Node Port (Optional)"
                                  description: "This port gets exposed to the node. Only considered when service type is NodePort, Simple or LoadBalancer"
                                  schema:
                                    type: int
                                    min: 9000
                                    max: 65535
                                - variable: targetPort
                                  label: "Target Port"
                                  description: "The internal(!) port on the container the Application runs on"
                                  schema:
                                    type: int
                                    default: 3306

  - variable: serviceexpert
    group: "Networking and Services"
    label: "Show Expert Config"
    schema:
      type: boolean
      default: false
      show_subquestions_if: true
      subquestions:
        - variable: hostNetwork
          group: "Networking and Services"
          label: "Host-Networking (Complicated)"
          schema:
            type: boolean
            default: false

        - variable: dnsPolicy
          group: "Networking and Services"
          label: "dnsPolicy"
          schema:
            type: string
            default: ""
            enum:
              - value: ""
                description: "Default"
              - value: "ClusterFirst"
                description: "ClusterFirst"
              - value: "ClusterFirstWithHostNet"
                description: "ClusterFirstWithHostNet"
              - value: "None"
                description: "None"

        - variable: dnsConfig
          label: "DNS Configuration"
          group: "Networking and Services"
          description: "Specify custom DNS configuration which will be applied to the pod"
          schema:
            type: dict
            attrs:
              - variable: nameservers
                label: "Nameservers"
                schema:
                  default: []
                  type: list
                  items:
                    - variable: nameserver
                      label: "Nameserver"
                      schema:
                        type: string
              - variable: options
                label: "options"
                schema:
                  default: []
                  type: list
                  items:
                    - variable: option
                      label: "Option Entry"
                      schema:
                        type: dict
                        attrs:
                          - variable: name
                            label: "Name"
                            schema:
                              type: string
                          - variable: value
                            label: "Value"
                            schema:
                              type: string
              - variable: searches
                label: "Searches"
                schema:
                  default: []
                  type: list
                  items:
                    - variable: search
                      label: "Search Entry"
                      schema:
                        type: string

        - variable: serviceList
          label: "Add Manual Custom Services"
          group: "Networking and Services"
          schema:
            type: list
            default: []
            items:
              - variable: serviceListEntry
                label: "Custom Service"
                schema:
                  type: dict
                  attrs:
                    - variable: enabled
                      label: "Enable the service"
                      schema:
                        type: boolean
                        default: true
                        hidden: true
                    - variable: name
                      label: "Name"
                      schema:
                        type: string
                        default: ""
                    - variable: type
                      label: "Service Type"
                      description: "ClusterIP's are only internally available, nodePorts expose the container to the host node System, Loadbalancer exposes the service using the system loadbalancer"
                      schema:
                        type: string
                        default: "Simple"
                        enum:
                          - value: "Simple"
                            description: "Simple"
                          - value: "NodePort"
                            description: "NodePort"
                          - value: "ClusterIP"
                            description: "ClusterIP"
                          - value: "LoadBalancer"
                            description: "LoadBalancer"
                    - variable: loadBalancerIP
                      label: "LoadBalancer IP"
                      description: "LoadBalancerIP"
                      schema:
                        show_if: [["type", "=", "LoadBalancer"]]
                        type: string
                        default: ""
                    - variable: externalIPs
                      label: "External IP's"
                      description: "External IP's"
                      schema:
                        show_if: [["type", "=", "LoadBalancer"]]
                        type: list
                        default: []
                        items:
                          - variable: externalIP
                            label: "External IP"
                            schema:
                              type: string
                    - variable: portsList
                      label: "Additional Service Ports"
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: portsListEntry
                            label: "Custom ports"
                            schema:
                              type: dict
                              attrs:
                                - variable: enabled
                                  label: "Enable the port"
                                  schema:
                                    type: boolean
                                    default: true
                                    hidden: true
                                - variable: name
                                  label: "Port Name"
                                  schema:
                                    type: string
                                    default: ""
                                - variable: protocol
                                  label: "Port Type"
                                  schema:
                                    type: string
                                    default: "TCP"
                                    enum:
                                      - value: HTTP
                                        description: "HTTP"
                                      - value: "HTTPS"
                                        description: "HTTPS"
                                      - value: TCP
                                        description: "TCP"
                                      - value: "UDP"
                                        description: "UDP"
                                - variable: targetPort
                                  label: "Target Port"
                                  description: "This port exposes the container port on the service"
                                  schema:
                                    type: int
                                    required: true
                                - variable: port
                                  label: "Container Port"
                                  schema:
                                    type: int
                                    required: true
                                - variable: nodePort
                                  label: "Node Port (Optional)"
                                  description: "This port gets exposed to the node. Only considered when service type is NodePort"
                                  schema:
                                    type: int
                                    min: 9000
                                    max: 65535

  - variable: volumeClaimTemplates
    label: "Integrated Persistent Storage"
    description: "Integrated Persistent Storage"
    group: "Storage and Persistence"
    schema:
      type: dict
      attrs:
        - variable: data
          label: "DB Storage"
          description: "Stores the old Application Database."
          schema:
            type: dict
            hidden: true
            attrs:
              - variable: enabled
                label: "Enable the storage"
                schema:
                  type: boolean
                  default: true
                  hidden: true
              - variable: type
                label: "Type of Storage"
                description: "Sets the persistence type, Anything other than PVC could break rollback!"
                schema:
                  type: string
                  default: "simplePVC"
                  enum:
                    - value: "simplePVC"
                      description: "PVC (simple)"
                    - value: "pvc"
                      description: "pvc"
              - variable: setPermissionsSimple
                label: "Automatic Permissions"
                description: "Automatically set permissions on install"
                schema:
                  show_if: [["type", "=", "simpleHP"]]
                  type: boolean
                  default: true
              - variable: setPermissions
                label: "Automatic Permissions"
                description: "Automatically set permissions on install"
                schema:
                  show_if: [["type", "=", "hostPath"]]
                  type: boolean
                  default: true
              - variable: readOnly
                label: "readOnly"
                schema:
                  type: boolean
                  default: false
              - variable: hostPathSimple
                label: "hostPath"
                description: "Path inside the container the storage is mounted"
                schema:
                  show_if: [["type", "=", "simpleHP"]]
                  type: hostpath
              - variable: hostPath
                label: "hostPath"
                description: "Path inside the container the storage is mounted"
                schema:
                  show_if: [["type", "=", "hostPath"]]
                  type: hostpath
              - variable: mountPath
                label: "mountPath"
                description: "Path inside the container the storage is mounted"
                schema:
                  type: string
                  default: "/bitnami/mariadb"
                  hidden: true
                  valid_chars: '^\/([a-zA-Z0-9._-]+(\s?[a-zA-Z0-9._-]+|\/?))+$'
              - variable: medium
                label: "EmptyDir Medium"
                schema:
                  show_if: [["type", "=", "emptyDir"]]
                  type: string
                  default: ""
                  enum:
                    - value: ""
                      description: "Default"
                    - value: "Memory"
                      description: "Memory"
              - variable: size
                label: "Size quotum of storage"
                schema:
                  show_if: [["type", "=", "pvc"]]
                  type: string
                  default: "999Gi"
              - variable: hostPathType
                label: "(Advanced) hostPath Type"
                schema:
                  show_if: [["type", "=", "hostPath"]]
                  type: string
                  default: ""
                  enum:
                    - value: ""
                      description: "Default"
                    - value: "DirectoryOrCreate"
                      description: "DirectoryOrCreate"
                    - value: "Directory"
                      description: "Directory"
                    - value: "FileOrCreate"
                      description: "FileOrCreate"
                    - value: "File"
                      description: "File"
                    - value: "Socket"
                      description: "Socket"
                    - value: "CharDevice"
                      description: "CharDevice"
                    - value: "BlockDevice"
                      description: "BlockDevice"
              - variable: storageClass
                label: "(Advanced) storageClass"
                description: "Warning: Anything other than SCALE-ZFS or empty will break rollback!"
                schema:
                  show_if: [["type", "=", "pvc"]]
                  type: string
                  default: "SCALE-ZFS"
              - variable: accessMode
                label: "(Advanced) Access Mode"
                description: "Allow or disallow multiple PVC's writhing to the same PV"
                schema:
                  show_if: [["type", "=", "pvc"]]
                  type: string
                  default: "ReadWriteOnce"
                  enum:
                    - value: "ReadWriteOnce"
                      description: "ReadWriteOnce"
                    - value: "ReadOnlyMany"
                      description: "ReadOnlyMany"
                    - value: "ReadWriteMany"
                      description: "ReadWriteMany"
              - variable: advanced
                label: "Show Advanced Options"
                schema:
                  type: boolean
                  default: false
                  show_subquestions_if: true
                  subquestions:
                    - variable: labelsList
                      label: "Labels"
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: labelItem
                            label: "Label"
                            schema:
                              type: dict
                              attrs:
                                - variable: name
                                  label: "Name"
                                  schema:
                                    type: string
                                - variable: value
                                  label: "Value"
                                  schema:
                                    type: string
                    - variable: annotationsList
                      label: "Annotations"
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: annotationItem
                            label: "Label"
                            schema:
                              type: dict
                              attrs:
                                - variable: name
                                  label: "Name"
                                  schema:
                                    type: string
                                - variable: value
                                  label: "Value"
                                  schema:
                                    type: string

  - variable: persistenceList
    label: "Additional app storage"
    group: "Storage and Persistence"
    schema:
      type: list
      default: []
      items:
        - variable: persistenceListEntry
          label: "Custom Storage"
          schema:
            type: dict
            attrs:
              - variable: enabled
                label: "Enable the storage"
                schema:
                  type: boolean
                  default: true
                  hidden: true
              - variable: name
                label: "Name (optional)"
                description: "Not required, please set to config when mounting /config or temp when mounting /tmp"
                schema:
                  type: string
              - variable: type
                label: "Type of Storage"
                description: "Sets the persistence type, Anything other than PVC could break rollback!"
                schema:
                  type: string
                  default: "simpleHP"
                  enum:
                    - value: "simplePVC"
                      description: "PVC (simple)"
                    - value: "simpleHP"
                      description: "HostPath (simple)"
                    - value: "emptyDir"
                      description: "emptyDir"
                    - value: "pvc"
                      description: "pvc"
                    - value: "hostPath"
                      description: "hostPath"
              - variable: setPermissionsSimple
                label: "Automatic Permissions"
                description: "Automatically set permissions on install"
                schema:
                  show_if: [["type", "=", "simpleHP"]]
                  type: boolean
                  default: true
              - variable: setPermissions
                label: "Automatic Permissions"
                description: "Automatically set permissions on install"
                schema:
                  show_if: [["type", "=", "hostPath"]]
                  type: boolean
                  default: true
              - variable: readOnly
                label: "readOnly"
                schema:
                  type: boolean
                  default: false
              - variable: hostPathSimple
                label: "hostPath"
                description: "Path inside the container the storage is mounted"
                schema:
                  show_if: [["type", "=", "simpleHP"]]
                  type: hostpath
              - variable: hostPath
                label: "hostPath"
                description: "Path inside the container the storage is mounted"
                schema:
                  show_if: [["type", "=", "hostPath"]]
                  type: hostpath
              - variable: mountPath
                label: "mountPath"
                description: "Path inside the container the storage is mounted"
                schema:
                  type: string
                  default: ""
                  required: true
                  valid_chars: '^\/([a-zA-Z0-9._-]+(\s?[a-zA-Z0-9._-]+|\/?))+$'
              - variable: medium
                label: "EmptyDir Medium"
                schema:
                  show_if: [["type", "=", "emptyDir"]]
                  type: string
                  default: ""
                  enum:
                    - value: ""
                      description: "Default"
                    - value: "Memory"
                      description: "Memory"
              - variable: size
                label: "Size quotum of storage"
                schema:
                  show_if: [["type", "=", "pvc"]]
                  type: string
                  default: "999Gi"
              - variable: hostPathType
                label: "(Advanced) hostPath Type"
                schema:
                  show_if: [["type", "=", "hostPath"]]
                  type: string
                  default: ""
                  enum:
                    - value: ""
                      description: "Default"
                    - value: "DirectoryOrCreate"
                      description: "DirectoryOrCreate"
                    - value: "Directory"
                      description: "Directory"
                    - value: "FileOrCreate"
                      description: "FileOrCreate"
                    - value: "File"
                      description: "File"
                    - value: "Socket"
                      description: "Socket"
                    - value: "CharDevice"
                      description: "CharDevice"
                    - value: "BlockDevice"
                      description: "BlockDevice"
              - variable: storageClass
                label: "(Advanced) storageClass"
                description: "Warning: Anything other than SCALE-ZFS or empty will break rollback!"
                schema:
                  show_if: [["type", "=", "pvc"]]
                  type: string
                  default: "SCALE-ZFS"
              - variable: accessMode
                label: "(Advanced) Access Mode"
                description: "Allow or disallow multiple PVC's writhing to the same PV"
                schema:
                  show_if: [["type", "=", "pvc"]]
                  type: string
                  default: "ReadWriteOnce"
                  enum:
                    - value: "ReadWriteOnce"
                      description: "ReadWriteOnce"
                    - value: "ReadOnlyMany"
                      description: "ReadOnlyMany"
                    - value: "ReadWriteMany"
                      description: "ReadWriteMany"
              - variable: advanced
                label: "Show Advanced Options"
                schema:
                  type: boolean
                  default: false
                  show_subquestions_if: true
                  subquestions:
                    - variable: labelsList
                      label: "Labels"
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: labelItem
                            label: "Label"
                            schema:
                              type: dict
                              attrs:
                                - variable: name
                                  label: "Name"
                                  schema:
                                    type: string
                                - variable: value
                                  label: "Value"
                                  schema:
                                    type: string
                    - variable: annotationsList
                      label: "Annotations"
                      schema:
                        type: list
                        default: []
                        items:
                          - variable: annotationItem
                            label: "Label"
                            schema:
                              type: dict
                              attrs:
                                - variable: name
                                  label: "Name"
                                  schema:
                                    type: string
                                - variable: value
                                  label: "Value"
                                  schema:
                                    type: string

  - variable: advancedresources
    label: "Set Custom Resource Limits/Requests (Advanced)"
    group: "Resources and Devices"
    schema:
      type: boolean
      default: false
      show_subquestions_if: true
      subquestions:
        - variable: resources
          label: ""
          schema:
            type: dict
            attrs:
              - variable: limits
                label: "Advanced Limit Resource Consumption"
                schema:
                  type: dict
                  attrs:
                    - variable: cpu
                      label: "CPU"
                      schema:
                        type: string
                        default: "4000m"
                        valid_chars: '^(?!^0(\.0|m|)$)([0-9]+)(\.[0-9]|m?)$'
                    - variable: memory
                      label: "Memory RAM"
                      schema:
                        type: string
                        default: "8Gi"
                        valid_chars: '^(?!^0(e[0-9]|[EPTGMK]i?|)$)([0-9]+)(|[EPTGMK]i?|e[0-9]+)$'
              - variable: requests
                label: "Advanced Request minimum resources required"
                schema:
                  type: dict
                  attrs:
                    - variable: cpu
                      label: "CPU"
                      schema:
                        type: string
                        default: "10m"
                        valid_chars: '^(?!^0(\.0|m|)$)([0-9]+)(\.[0-9]|m?)$'
                    - variable: memory
                      label: "Memory RAM"
                      schema:
                        type: string
                        default: "50Mi"
                        valid_chars: '^(?!^0(e[0-9]|[EPTGMK]i?|)$)([0-9]+)(|[EPTGMK]i?|e[0-9]+)$'
